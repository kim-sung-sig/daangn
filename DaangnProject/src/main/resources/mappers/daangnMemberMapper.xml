<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "//mybatis.org/DTD Mapper 3.0//EN" "./mybatis-3-mapper.dtd" >
<mapper namespace="kr.ezen.daangn.dao.DaangnMemberDAO">

	<!-- 회원가입할때 -->
	<insert id="insert" parameterType="DaangnMemberVO">
		insert into 
			daangn_member
		values
			(
				daangn_member_idx_seq.nextval
				, #{username}
				, #{password}
				, #{role}
				, #{name}
				, #{nickName}
				, #{email}
				, #{stAddress}
				, #{dtAddress}
			)
	</insert>

	<!-- userDetails -->
	<select id="selectByUsername" parameterType="string" resultType="DaangnMemberVO">
		select * from daangn_member where username = #{username}
	</select>
	
	<!-- idx로 idx와 nickName만 얻기 -->
	<select id="selectByIdx" parameterType="int" resultType="DaangnMemberVO">
		select idx, nickName from daangn_member where idx = #{idx}
	</select>
	
	<!-- 중복확인을 위한 코드 -->
	<select id="selectCountByUsername" parameterType="string" resultType="int">
		select count(*) from daangn_member where username = #{username}
	</select>
	
	
	<!-- 마이페이지 및 관리자페이지용 -->
	<!-- idx로 모두 얻기 -->
	<select id="selectAllByIdx" parameterType="int" resultType="DaangnMemberVO">
		select * from daangn_member where idx = #{idx}
	</select>
	
	<!-- 모두 얻기 (admin용) 이거 페이징 처리해야댐 -->
	<select id="selectAll" resultType="DaangnMemberVO">
		select * from daangn_member order by username
	</select>
	
	<!-- 회원 정보 수정 -->
	<update id="update" parameterType="DaangnMemberVO">
		update 
			daangn_member 
		set 
			nickName = #{nickName}
			, email = #{email}
			, stAddress = #{stAddress}
			, dtAddress = #{dtAddress}
		where 
			idx = #{idx}
	</update>
	
	<!-- 권한수정 -->
	<update id="updateRole" parameterType="DaangnMemberVO">
		update 
			daangn_member 
		set 
			role = #{role}
		where 
			username = #{username}
	</update>
	
	<!-- 비밀번호 수정 암호화해서 넘겨야한다 -->
	<update id="updatePassword" parameterType="DaangnMemberVO">
		update 
			daangn_member 
		set 
			password = #{password}
		where 
			username = #{username}
	</update>
	
	<!-- 탈퇴하기 idx-->
	<delete id="deleteByIdx" parameterType="int">
		delete from daangn_member where idx = #{idx}
	</delete>
	
	<!-- 탈퇴하기 username-->
	<delete id="deleteByUsername" parameterType="string">
		delete from daangn_member where username = #{username}
	</delete>
	
	
</mapper>